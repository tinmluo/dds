angular.module("youtube-embed",["ng"]).run(function(){var e=document.createElement("script");e.src="//www.youtube.com/iframe_api";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}).service("$youtube",["$window","$rootScope",function(e,t){function n(e,t){return e.indexOf(t)>-1}function r(e){t.$apply(function(){t.$broadcast(e)})}function o(){r(y+"ready")}function i(e){var t=l[e.data];void 0!==typeof t&&r(y+t),u.currentState=t}var a=/https?:\/\/(?:[0-9A-Z-]+\.)?(?:youtu\.be\/|youtube(?:-nocookie)?\.com\S*[^\w\s-])([\w-]{11})(?=[^\w-]|$)(?![?=&+%\w.-]*(?:['"][^<>]*>|<\/a>))[?=&+%\w.-]*/gi,d=/t=(\d+)[ms]?(\d+)?s?/,u={ready:!1,playerId:null,player:null,videoId:null,playerHeight:"390",playerWidth:"640",currentState:null,setURL:function(e){u.videoId=u.getIdFromURL(e)},getIdFromURL:function(e){var t=e.replace(a,"$1");if(n(t,";")){var r=t.split(";");if(n(r[1],"%")){var o=decodeURIComponent(t.split(";")[1]);t=("http://youtube.com"+o).replace(a,"$1")}else t=r[0]}else n(t,"#")&&(t=t.split("#")[0]);return t},getTimeFromURL:function(e){e||(e="");var t=e.match(d);if(!t)return void 0;var r=t[0],o=t[1],i=t[2];return"undefined"!=typeof i?(i=parseInt(i,10),o=parseInt(o,10)):n(r,"m")?(o=parseInt(o,10),i=0):(i=parseInt(o,10),o=0),i+60*o},createPlayer:function(){return new YT.Player(this.playerId,{height:this.playerHeight,width:this.playerWidth,videoId:this.videoId,events:{onReady:o,onStateChange:i}})},loadPlayer:function(){this.ready&&this.playerId&&this.videoId&&(this.player&&"function"==typeof this.player.destroy&&this.player.destroy(),this.player=this.createPlayer())}},l={0:"ended",1:"playing",2:"paused",3:"buffering",5:"queued"},y="youtube.player.";return e.onYouTubeIframeAPIReady=function(){t.$apply(function(){u.ready=!0})},u}]).directive("youtubeVideo",["$youtube",function(e){return{restrict:"EA",scope:{videoId:"=",videoUrl:"="},link:function(t,n){e.playerId=n[0].id;var r=t.$watch(function(){return e.player.ready&&("undefined"!=typeof t.videoUrl||"undefined"!=typeof t.videoId)},function(n){n&&(r(),"undefined"!=typeof t.videoUrl?t.$watch("videoUrl",function(t){e.setURL(t),e.loadPlayer()}):t.$watch("videoId",function(t){e.videoId=t,e.loadPlayer()}))})}}}]);